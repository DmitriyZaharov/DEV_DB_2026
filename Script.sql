--Лабораторная работа 1
--
--Задание 1. Знакомство с БД dbSQL
--1)	Установите интегрированную среду разработки (DBeaver или др)
--2)	Используя интегрированную среду разработки установите подключение к БД dbSQL
--a.	Имя сервера: vpngw.avalon.ru
--b.	Порт сервера: 5432
--c.	Имя БД:
--d.	Имя пользователя: pguser
--e.	Пароль: Pa$$w0rd
--3)	Раскройте контейнер БД dbSQL и ознакомьтесь со списком таблиц
--a.	Как называется и в какой схеме находится таблица, содержащая список сотрудников?
--        __HR.Employers___________________________
--b.	Как называется и в какой схеме находится таблица, содержащая список клиентов?
--_________Sales.Customers____________________
--4)	Изучите перечень полей в каждой пользовательской таблице БД dbSQL
--5)	Как называется и в какой схеме находится таблица, содержащая данные о заказах?
--___________схема:Sales таблица:Orders__________________
--a.	В каком поле таблицы Заказы содержится информация об адресе доставки?
--_____________схема:Sales.таблица:Orders.поле:hipaddres________________
--b.	Данные какого типа хранятся в столбце Дата заказа?
--_____________________date________
--c.	Какое поле используется в качестве Первичного ключа?
--____________________prderid, productid_________
--
--6)	Создайте диаграмму БД dbSQL (схему БД)
--7)	Изучите связи между таблицами.
--a.	Какое поле в таблице Заказы используется в качестве внешнего ключа для связи с таблицей Сотрудники?
--______________empid_______________
--b.	Какое поле в таблице Сотрудники используется для связи записей внутри таблицы (Начальник – Подчиненный)?
--_______________mgrid______________
--
-- 
--Задание 2. Написание простых запросов (работаем с БД dbTSQL)
--Создание элементарных запросов без проекции (все столбцы) и фильтрации 
--1.	Выведите список всех продуктов 
select productname  from "Production"."Products";
--2.	Выведите список всех заказчиков
select companyname from "Sales"."Customers"; 
--3.	Выведите список всех сотрудников
select lastname,firstname  from "HR"."Employees";
--Создание запросов с проекцией и обработкой столбцов
--1.	Выведите названия страны, региона и города, в которых проживают заказчики
select country, region, city from "Sales"."Customers";
--2.	Выведите название и стоимость продуктов, упорядочив результирующую выборку в порядке убывания стоимости
--SELECT * 
--FROM название_таблицы
--ORDER BY стоимость DESC;

select productname, unitprice from "Production"."Products" order by unitprice desc;
--Задание 3. Написание запросов с вычисляемыми столбцами
--1.	На основе таблицы Employees напишите запрос, возвращающий таблицу из 3 столбцов: Фамилия сотрудника, Имя сотрудника, e-mail адрес.
--Столбец e-mail адрес должен быть сформирован в соответствие со следующим шаблоном: <имя>.<фамилия>@<названиеорганизации>.ru. Название организации придумайте сами! Полученные e-mail должны быть в нижнем регистре. Символы, недопустимые в адресе эл.почты, должны быть заменены нижним подчеркиванием.
-- 
--2.	На основании данных ТОЛЬКО таблицы Products (запрос только к одной таблице!) сформируйте таблицу из трех столбцов: Номер категории, Название продукта и Название категории. 
--Название категории должно выводиться в соответствии с ее номером:
--1 -  'Beverages'; 2 - 'Condiments'; 3 - 'Confections'; 4 - 'Dairy Products'; 5 - 'Grains/Cereals'; 6 - 'Meat/Poultry';  7 - 'Produce'; 8 - 'Seafood'. Для категорий, не попавших в данный список, необходимо вернуть значение  'Other'
-- 
--3.	Напишите запрос к таблице Customers, возвращающий таблицу из 3 столбцов: contactname, LName и FName. Значение в столбцах LName и FName должны вычисляться на основе данных столбца contactname. (Можно использовать регулярные выражения!)
-- 
--4.	Напишите запрос к таблице OrderDetails, возвращающий таблицу из 3 столбцов: unitprice, qty и LineTotal. Значение в столбце LineTotal – является расчетной величиной с учетом количества товара, цены и скидки.
-- 
--Задание 4. Написание запросов с сортировкой
--1.	Выведите 10 самых дорогих товаров.
--2.	Выведите из таблицы Orders строки с 51 по 100, упорядоченные по дате заказа
